<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>VFML: BeliefNet.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>BeliefNet.h</h1><a href="BeliefNet_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef BELIEFNETH</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define BELIEFNETH</span>
00003 <span class="preprocessor"></span>
00008 <span class="preprocessor">#include "<a class="code" href="ExampleSpec_8h.html">ExampleSpec.h</a>"</span>
00009 <span class="preprocessor">#include "<a class="code" href="Example_8h.html">Example.h</a>"</span>
00010 <span class="preprocessor">#include "../util/lists.h"</span>
00011 <span class="comment">/*#include &lt;stdio.h&gt;*/</span>
00012 
<a name="l00047"></a><a class="code" href="struct__BeliefNetNode__.html">00047</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__BeliefNetNode__.html">_BeliefNetNode_</a> {
00048    <span class="keywordtype">int</span> numAllocatedRows;
00049    <span class="keywordtype">int</span> numParentCombinations;
00050 
00051    <span class="comment">// indexed first by parents in order in counting order</span>
00052    <span class="comment">//  second index on value for this variable</span>
00053    <span class="keywordtype">float</span> **eventCounts;
00054 
00055    <span class="comment">// the number of times this parent combination occured.</span>
00056    <span class="keywordtype">float</span> *rowCounts;
00057 
00058    <span class="comment">// This is the sum of all the rowCounts;</span>
00059    <span class="keywordtype">float</span> numSamples;
00060 
00061    <a class="code" href="struct__ExampleSpec__.html">ExampleSpecPtr</a> spec;
00062    <span class="keywordtype">int</span> attributeID;
00063 
00064    <span class="keyword">struct </span><a class="code" href="struct__BeliefNet__.html">_BeliefNet_</a> *bn;
00065 
00066    <a class="code" href="structVoidListPtr.html">VoidListPtr</a> parentIDs;
00067    <a class="code" href="structVoidListPtr.html">VoidListPtr</a> childrenIDs;
00068    <span class="keywordtype">void</span> *userData;
00069 
00070    <span class="comment">/* used internally by graph algorithms or inference algorithms,</span>
00071 <span class="comment">       do not use it for things you want preserved across calls,</span>
00072 <span class="comment">       use userData for that */</span>
00073    <span class="keywordtype">void</span> *tmpInternalData;
00074 } <a class="code" href="struct__BeliefNetNode__.html">BeliefNetNodeStruct</a>, *<a class="code" href="struct__BeliefNetNode__.html">BeliefNetNode</a>;
00075 
00076 
00077 <span class="comment">//BeliefNetNode BNNodeNew(void);</span>
00078 
00079 <span class="keywordtype">void</span> BNNodeFree(BeliefNetNode bnn);
00080 
00081 <span class="comment">// NOTE! Both nodes better have CPTs allocated and they better be the same</span>
00082 <span class="keywordtype">void</span> BNNodeSetCPTFrom(BeliefNetNode target, BeliefNetNode source);
00083 
00084 <span class="comment">// Note: this does NOT clone user data, merely copies the pointer</span>
00085 <a class="code" href="BeliefNet_8h.html#a3">BeliefNetNode</a> BNNodeClone(BeliefNetNode bnn);
00086 
00091 <span class="keywordtype">void</span> BNNodeAddParent(BeliefNetNode bnn, BeliefNetNode parent);
00092 <span class="comment">//void BNNodeAddChild(BeliefNetNode bnn, BeliefNetNode child);</span>
00093 
00098 <span class="keywordtype">int</span> BNNodeLookupParentIndex(BeliefNetNode bnn, BeliefNetNode parent);
00099 
00104 <span class="keywordtype">int</span> BNNodeLookupParentIndexByID(BeliefNetNode bnn, <span class="keywordtype">int</span> id);
00105 
00110 <span class="keywordtype">void</span> BNNodeRemoveParent(BeliefNetNode bnn, <span class="keywordtype">int</span> parentIndex);
00111 
00113 <a class="code" href="BeliefNet_8h.html#a3">BeliefNetNode</a> BNNodeGetParent(BeliefNetNode bnn, <span class="keywordtype">int</span> parentIndex);
00114 
00116 <span class="keywordtype">int</span> BNNodeGetParentID(BeliefNetNode bnn, <span class="keywordtype">int</span> parentIndex);
00117 
00119 <span class="keywordtype">int</span> BNNodeGetNumParents(BeliefNetNode bnn);
00120 
00122 <span class="keywordtype">int</span> BNNodeGetNumChildren(BeliefNetNode bnn);
00123 
00125 <span class="keywordtype">int</span> BNNodeHasParent(BeliefNetNode bnn, BeliefNetNode parent);
00126 
00128 <span class="keywordtype">int</span> BNNodeHasParentID(BeliefNetNode bnn, <span class="keywordtype">int</span> parentID);
00129 
00130 <span class="keywordtype">void</span> BNNodeAddValue(BeliefNetNode bnn, <span class="keywordtype">char</span> *valueName);
00131 <span class="keywordtype">int</span> BNNodeLookupValue(BeliefNetNode bnn, <span class="keywordtype">char</span> *valueName);
00132 
00134 <span class="keywordtype">int</span> BNNodeGetNumValues(BeliefNetNode bnn);
00135 
00137 <span class="keywordtype">int</span> BNNodeGetNumParameters(BeliefNetNode bnn);
00138 
00140 <span class="keywordtype">char</span> *BNNodeGetName(BeliefNetNode bnn);
00141 
00146 <span class="keywordtype">int</span> BNNodeStructureEqual(BeliefNetNode bnn, BeliefNetNode otherNode);
00147 
00148 
00155 <span class="keywordtype">void</span> BNNodeInitCPT(BeliefNetNode bnn);
00156 
00157 
00162 <span class="keywordtype">void</span> BNNodeZeroCPT(BeliefNetNode bnn);
00163 
00172 <span class="keywordtype">void</span> BNNodeFreeCPT(BeliefNetNode bnn);
00173 
00174 <span class="comment">// returns the attribute id of the node (once the node's identity is set)</span>
00175 <span class="keywordtype">int</span> BNNodeGetID(BeliefNetNode bnn);
00176 
00177 <span class="keywordtype">void</span> BNNodeSetUserData(BeliefNetNode bnn, <span class="keywordtype">void</span> *data);
00178 <span class="comment">//inline void *BNNodeGetUserData(BeliefNetNode bnn) {return bnn-&gt;userData;}</span>
00179 <span class="preprocessor">#define BNNodeGetUserData(bnn) (((BeliefNetNode)bnn)-&gt;userData)</span>
00180 <span class="preprocessor"></span>
00181 
00189 <span class="keywordtype">void</span>  BNNodeAddSample(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00190 
00192 <span class="keywordtype">void</span>  BNNodeAddSamples(BeliefNetNode bnn, <a class="code" href="structVoidListPtr.html">VoidListPtr</a> samples);
00193 
00200 <span class="keywordtype">void</span>  BNNodeAddFractionalSample(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e, <span class="keywordtype">float</span> weight);
00201 
00203 <span class="keywordtype">void</span>  BNNodeAddFractionalSamples(BeliefNetNode bnn, <a class="code" href="structVoidListPtr.html">VoidListPtr</a> samples, <span class="keywordtype">float</span> weight);
00204 
00211 <span class="keywordtype">float</span> BNNodeGetCPTRowCount(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00212 
00213 
00224 <span class="keywordtype">float</span> BNNodeGetP(BeliefNetNode bnn, <span class="keywordtype">int</span> value);
00225 <span class="keywordtype">void</span>  BNNodeSetCPIndexed(BeliefNetNode bnn, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> value,
00226                                                       <span class="keywordtype">float</span> probability);
00227 <span class="keywordtype">float</span> BNNodeGetCPIndexed(BeliefNetNode bnn, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> value);
00228 
00235 <span class="keywordtype">float</span> BNNodeGetCP(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00236 
00249 <span class="keywordtype">void</span>  BNNodeSetCP(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e, <span class="keywordtype">float</span> probability);
00250 
00251 <span class="comment">// Reset all row counts to 'strength'.  This effectively sets the confidence</span>
00252 <span class="comment">//  in the current probabilities to be equal to what you would have after</span>
00253 <span class="comment">//  seeing 'strength' samples which add up to the current probabilities.</span>
00254 <span class="comment">//  (which may not be possible, but that's ok!)</span>
00255 <span class="keywordtype">void</span> BNNodeSetPriorStrength(BeliefNetNode bnn, <span class="keywordtype">double</span> strength);
00256 <span class="keywordtype">void</span> BNNodeSmoothProbabilities(BeliefNetNode bnn, <span class="keywordtype">double</span> strength);
00257 
00258 <span class="keywordtype">void</span> BNNodeSetRandomValueGivenParents(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00259 
00260 
00262 <span class="keywordtype">float</span> BNNodeGetNumSamples(BeliefNetNode bnn);
00263 
00265 <span class="keywordtype">int</span> BNNodeGetNumCPTRows(BeliefNetNode bnn);
00266 
<a name="l00278"></a><a class="code" href="struct__BeliefNet__.html">00278</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__BeliefNet__.html">_BeliefNet_</a> {
00279    <span class="keywordtype">char</span> *name;
00280    <a class="code" href="struct__ExampleSpec__.html">ExampleSpecPtr</a> spec;
00281    <a class="code" href="structVoidListPtr.html">VoidListPtr</a> nodes;
00282 
00283    <span class="comment">/* these next two contain cached values, will be 0 and -1 till filled */</span>
00284    <a class="code" href="structVoidListPtr.html">VoidListPtr</a> topoSort;
00285    <span class="keywordtype">int</span> hasCycle;
00286 
00287    <span class="keywordtype">void</span> *userData;
00288 } <a class="code" href="struct__BeliefNet__.html">BeliefNetStruct</a>, *<a class="code" href="struct__BeliefNet__.html">BeliefNet</a>;
00289 
00291 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNNew(<span class="keywordtype">void</span>);
00292 
00294 <span class="keywordtype">void</span> BNFree(BeliefNet bn);
00295 
00297 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNClone(BeliefNet bn);
00298 
00300 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNCloneNoCPTs(BeliefNet bn);
00301 
00310 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNNewFromSpec(<a class="code" href="struct__ExampleSpec__.html">ExampleSpecPtr</a> es);
00311 
00312 <span class="keywordtype">int</span> BNStructureEqual(BeliefNet bn, BeliefNet otherNet);
00313 
00321 <span class="keywordtype">int</span> BNGetSimStructureDifference(BeliefNet bn, BeliefNet otherNet);
00322 
00328 <span class="keywordtype">void</span> BNSetName(BeliefNet bn, <span class="keywordtype">char</span> *name);
00329 
00330 <span class="comment">// Needed for reading and writing examples that will work with the net</span>
00331 
00337 <a class="code" href="struct__ExampleSpec__.html">ExampleSpec</a> *BNGetExampleSpec(BeliefNet bn);
00338 
00339 <span class="comment">//void BNSetUserData(BeliefNet bn, int nodeID, void *data);</span>
00340 <span class="comment">//void *BNGetUserData(BeliefNet bn, int nodeID);</span>
00341 
00342 <span class="comment">//void BNAddNode(BeliefNet bn, BeliefNetNode bnn, char *nodeName);</span>
00343 
00344 <a class="code" href="BeliefNet_8h.html#a3">BeliefNetNode</a> BNNewNode(BeliefNet bn, <span class="keywordtype">char</span> *nodeName);
00345 
00346 <span class="comment">/* Looks up the node by name.</span>
00347 <span class="comment"></span>
00348 <span class="comment">This is an O(N) operation. If it isn't found returns NULL. */</span>
00349 <a class="code" href="BeliefNet_8h.html#a3">BeliefNetNode</a> BNLookupNode(BeliefNet bn, <span class="keywordtype">char</span> *name);
00350 
00354 <a class="code" href="BeliefNet_8h.html#a3">BeliefNetNode</a> BNGetNodeByID(BeliefNet bn, <span class="keywordtype">int</span> id);
00355 
00357 <span class="keywordtype">int</span> BNGetNumNodes(BeliefNet bn);
00358 
00370 <a class="code" href="BeliefNet_8h.html#a3">BeliefNetNode</a> BNGetNodeByElimOrder(BeliefNet bn, <span class="keywordtype">int</span> index);
00371 
00379 <span class="keywordtype">int</span> BNHasCycle(BeliefNet bn);
00380 
00392 <span class="keywordtype">void</span> BNFlushStructureCache(BeliefNet bn);
00393 
00394 <span class="comment">/* \brief Calls BNNodeZeroCPT on every node in the network. */</span>
00395 <span class="keywordtype">void</span> BNZeroCPTs(BeliefNet bn);
00396 
00397 <span class="comment">//void BNPrint(BeliefNet bn, FILE *out);</span>
00398 <span class="comment">//void BNPrintStats(BeliefNet bn, FILE *out);</span>
00399 
00405 <span class="keywordtype">void</span> BNAddSample(BeliefNet bn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00406 
00408 <span class="keywordtype">void</span> BNAddSamples(BeliefNet bn, <a class="code" href="structVoidListPtr.html">VoidListPtr</a> samples);
00409 
00415 <span class="keywordtype">void</span> BNAddFractionalSample(BeliefNet bn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e, <span class="keywordtype">float</span> weight);
00416 
00418 <span class="keywordtype">void</span> BNAddFractionalSamples(BeliefNet bn, <a class="code" href="structVoidListPtr.html">VoidListPtr</a> samples, <span class="keywordtype">float</span> weight);
00419 
00420 <span class="comment">/* \brief Returns the loglikelihood of the example given the network and parameters. */</span>
00421 <span class="keywordtype">float</span> BNGetLogLikelihood(BeliefNet bn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00422 
00429 <span class="keywordtype">long</span> BNGetNumIndependentParameters(BeliefNet bn);
00430 
00432 <span class="keywordtype">long</span> BNGetNumParameters(BeliefNet bn);
00433 
00435 <span class="keywordtype">long</span> BNGetMaxNodeParameters(BeliefNet bn);
00436 
00437 
00443 <a class="code" href="struct__Example__.html">ExamplePtr</a> BNGenerateSample(BeliefNet bn);
00444 
00454 <span class="keywordtype">void</span> BNSetPriorStrength(BeliefNet bn, <span class="keywordtype">double</span> strength);
00455 
00461 <span class="keywordtype">void</span> BNSmoothProbabilities(BeliefNet bn, <span class="keywordtype">double</span> strength);
00462 
00467 <span class="keywordtype">void</span> BNSetUserData(BeliefNet bn, <span class="keywordtype">void</span> *data);
00468 
00469 <span class="comment">// void *BNGetUserData(BeliefNet bn) {return bn-&gt;userData;}</span>
<a name="l00474"></a><a class="code" href="BeliefNet_8h.html#a1">00474</a> <span class="comment"></span><span class="preprocessor">#define BNGetUserData(bn) (((BeliefNet)bn)-&gt;userData)</span>
00475 <span class="preprocessor"></span>
00481 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNReadBIF(<span class="keywordtype">char</span> *fileName);
00482 
00483 
00489 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNReadBIFFILEP(FILE *file);
00490 
00498 <span class="keywordtype">void</span> BNWriteBIF(BeliefNet bn, FILE *out);
00499 
00504 <span class="keywordtype">void</span> BNPrintStats(BeliefNet bn);
00505 
00506 
00507 
00508 
00509 <span class="comment">/**************************************************</span>
00510 <span class="comment">  Mattr added below here and in .c.</span>
00511 <span class="comment">  Geoff, if you approve, I guess move up where they belong</span>
00512 <span class="comment">**************************************************/</span>
00513 <span class="comment">// Allocates and fills in eventCounts and rowCounts</span>
00514 <span class="keywordtype">void</span> BNNodeCopyCPT(BeliefNetNode bnn, <span class="keywordtype">float</span> ***eventCounts, <span class="keywordtype">float</span> **rowCounts);
00515 <span class="comment">// Restores from eventCounts and rowCounts back into the node</span>
00516 <span class="keywordtype">void</span> BNNodeRestoreCPT(BeliefNetNode bnn, <span class="keywordtype">float</span> **eventCounts, <span class="keywordtype">float</span> *rowCounts);
00517 <span class="comment">// Just allocates</span>
00518 <span class="keywordtype">void</span> BNNodeAllocateCPT(BeliefNetNode bnn, <span class="keywordtype">float</span> ***eventCounts, <span class="keywordtype">float</span> **rowCounts);
00519 <span class="comment">// Frees the result of one of the above two functions</span>
00520 <span class="keywordtype">void</span> BNNodeFreeCopiedCPT(BeliefNetNode bnn, <span class="keywordtype">float</span> **eventCounts, <span class="keywordtype">float</span> *rowCounts);
00521 
00522 <span class="keywordtype">void</span> BNNodeRemoveParentByID(BeliefNetNode bnn, <span class="keywordtype">int</span> parentID);
00523 <span class="keywordtype">void</span> BNNodeRemoveEdge(BeliefNetNode parent, BeliefNetNode child);
00524 
00525 <span class="comment">// If doDirichlet, then the event and rowCounts will be dirichlet parameters</span>
00526 <span class="comment">//  otherwise, they will be shrunken event and rowCounts</span>
00527 <span class="keywordtype">void</span>  BNNodeShrink(BeliefNetNode bnn, <a class="code" href="structVoidListPtr.html">VoidListPtr</a> data, <span class="keywordtype">int</span> doDirichlet);
00528 <span class="keywordtype">void</span> BNNodeTruncateToNParents(BeliefNetNode bnn, <a class="code" href="structVoidListPtr.html">VoidListPtr</a> data, 
00529                                <span class="keywordtype">int</span> maxParents);
00530 
00531 <span class="keywordtype">void</span> BNRemoveNode(BeliefNet bn, BeliefNetNode node);
00532 
00533 <span class="keywordtype">void</span> BNNodeCPTGetP(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e, <span class="keywordtype">double</span> *p);
00534 <span class="keywordtype">double</span> BNNodeCPTGetCP(BeliefNetNode bnn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00535 <span class="keywordtype">void</span> BNNodeGetJointProb(BeliefNetNode parent, BeliefNetNode child, <span class="keywordtype">double</span> p[2][2]);
00536 
00554 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNInitLikelihoodSampling(BeliefNet bn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e);
00555 
00562 <span class="keywordtype">void</span> BNAddLikelihoodSamples(BeliefNet bn, BeliefNet newNet, <a class="code" href="struct__Example__.html">ExamplePtr</a> e, <span class="keywordtype">int</span> numSamples);
00563 
00565 <a class="code" href="BeliefNet_8h.html#a5">BeliefNet</a> BNLikelihoodSampleNTimes(BeliefNet bn, <a class="code" href="struct__Example__.html">ExamplePtr</a> e, <span class="keywordtype">int</span> numSamples);
00569 <span class="preprocessor">#endif </span><span class="comment">/* BELIEFNETH */</span>
</pre></div><hr>
<small>Generated for VFML by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a>
hosted by <A href="http://sourceforge.net"> <IMG
src="http://sourceforge.net/sflogo.php?group_id=85301&amp;type=2"
width="125" height="37" border="0" alt="SourceForge.net Logo" /></A>
</small>
